const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/chunk-Post-k9o1aGYw.js","assets/chunk-mermaid-lib-C3SUPDTN.js","assets/entry-index-B6sojzRE.js","assets/asset-index-BzCrfPwL.css","assets/chunk-_plugin-vue_export-helper-DlAUqK2U.js","assets/asset-Post-35e-BP_e.css"])))=>i.map(i=>d[i]);
import{_ as B}from"./chunk-mermaid-lib-C3SUPDTN.js";import{r as g,f as D,n as G,j as I,i as y,v as j,b as p,o as f,a as F,e as v,w as V,F as T,k,c as N,u as Y,d as J,I as K,p as Q,g as X,q as Z,h as b,t as ee}from"./entry-index-B6sojzRE.js";import{g as x}from"./chunk-index-D-nlVayj.js";import{_ as te}from"./chunk-_plugin-vue_export-helper-DlAUqK2U.js";const oe={class:"PostPanel"},ae={class:"pagination"},se=["disabled"],ne=["disabled"],ie=["onClick","disabled"],re=["disabled"],le=["disabled"],ce={__name:"PostPanel",setup(ue){const S=J(()=>B(()=>import("./chunk-Post-k9o1aGYw.js"),__vite__mapDeps([0,1,2,3,4,5]))),m=g({}),a=g(1),r=g(b.PostsPerPage),u=g(0);g(0);async function C(){const t=Q.markdowns,o={};for(const[e,i]of Object.entries(t))try{if(e.includes("/WaterfallGraph/")||e.includes("\\WaterfallGraph\\")){console.log(`[PostPanel] Skipping WaterfallGraph file: ${e}`);continue}const P=(await X.get(e.startsWith("http")?e:new URL(e,import.meta.url).href)).data,{meta:n}=await Z(P),w=n.tags&&(Array.isArray(n.tags)?n.tags.includes("公告"):n.tags==="公告"),_=n.title&&n.title.toLowerCase()==="about";!w&&!_&&(o[e]=i)}catch(s){console.error(`Failed to check tags for ${e}:`,s),o[e]=i}m.value=o}function h(){const t=document.querySelector(".LeftList .context"),o=document.querySelector(".RightList .context"),e=t?t.offsetHeight:0,i=o?o.offsetHeight:0;if(u.value=Math.max(e,i),console.log("[PostPanel] Sidebar heights:",{leftHeight:e,rightHeight:i,max:u.value}),u.value===0){r.value=b.PostsPerPage;return}const s=document.querySelectorAll(".posts > *");let c=450;if(s.length>0){const w=Array.from(s).reduce(($,q)=>$+q.offsetHeight,0),_=(s.length-1)*16;c=(w+_)/s.length}const P=Math.ceil(u.value/c),n=Math.max(b.PostsPerPage,P);console.log("[PostPanel] Dynamic calculation:",{sidebarHeight:u.value,avgPostHeight:c,calculatedPosts:P,configMin:b.PostsPerPage,finalPostsPerPage:n}),Math.abs(r.value-n)>=1&&(r.value=n,console.log("[PostPanel] Updated posts per page to:",n))}let d=null;function L(){if(typeof ResizeObserver>"u")return;d=new ResizeObserver(()=>{window.resizeTimeout&&clearTimeout(window.resizeTimeout),window.resizeTimeout=setTimeout(()=>{h()},300)});const t=document.querySelector(".LeftList .context"),o=document.querySelector(".RightList .context");t&&d.observe(t),o&&d.observe(o)}D(async()=>{await C(),await G(),setTimeout(()=>{h()},500),setTimeout(()=>{h()},1e3),setTimeout(()=>{h(),L()},1500)}),I(()=>{d&&d.disconnect(),window.resizeTimeout&&clearTimeout(window.resizeTimeout)});const l=y(()=>Math.ceil(Object.keys(m.value).length/r.value)),z=y(()=>{const t=Object.keys(m.value).map(s=>({key:s,...m.value[s]})).sort((s,c)=>new Date(c.date)-new Date(s.date)),o=(a.value-1)*r.value,e=o+r.value,i=t.slice(o,e);return console.log(`Current Page: ${a.value}, Posts per page: ${r.value}, Start: ${o}, End: ${e}`),i});j(r,()=>{a.value>l.value&&(a.value=1)});const A=t=>{t>=1&&t<=l.value&&(a.value=t,window.scrollTo({top:0,behavior:"smooth"}))},E=()=>{a.value=1,window.scrollTo({top:0,behavior:"smooth"})},H=()=>{a.value=l.value,window.scrollTo({top:0,behavior:"smooth"})},M=()=>{a.value<l.value&&(a.value+=1,window.scrollTo({top:0,behavior:"smooth"}))},O=()=>{a.value>1&&(a.value-=1,window.scrollTo({top:0,behavior:"smooth"}))};function R(t){t.style.opacity=0,t.style.transform="translateY(30px)"}function U(t,o){const e=t.dataset.index*100;setTimeout(()=>{x.to(t,{opacity:1,y:0,duration:.6,ease:"power2.out",onComplete:o})},e)}function W(t,o){x.to(t,{opacity:0,y:-20,scale:.98,duration:.4,ease:"power2.in",onComplete:o})}return(t,o)=>(f(),p("div",oe,[F(K,{name:"list",tag:"div",class:"posts",onBeforeEnter:R,onEnter:U,onLeave:W,appear:""},{default:V(()=>[(f(!0),p(T,null,k(z.value,(e,i)=>(f(),N(Y(S),{key:e.key,imageUrl:e.imageUrl,markdownUrl:e.key,"data-index":i},null,8,["imageUrl","markdownUrl","data-index"]))),128))]),_:1}),v("div",ae,[v("button",{onClick:E,disabled:a.value===1},"最前页",8,se),v("button",{onClick:O,disabled:a.value===1},"前一页",8,ne),(f(!0),p(T,null,k(l.value,e=>(f(),p("button",{key:e,onClick:i=>A(e),disabled:a.value===e},ee(e),9,ie))),128)),v("button",{onClick:M,disabled:a.value===l.value},"后一页",8,re),v("button",{onClick:H,disabled:a.value===l.value},"最后页",8,le)])]))}},me=te(ce,[["__scopeId","data-v-4abd8ab1"]]);export{me as default};
