import{r as n,b as i,d,f as s,v as u,B as _,D as k,E as w,t as p}from"./index-D4QvT-69.js";import{d as g}from"./crypto-za4txypO.js";import{_ as b}from"./_plugin-vue_export-helper-DlAUqK2U.js";const h={class:"crypto-unlock"},x={class:"unlock-card"},B={class:"password-input-group"},D=["disabled"],U=["disabled"],C={key:0,class:"error-message"},E={key:1,class:"progress-bar"},V={__name:"CryptoUnlock",props:{encryptedUrl:{type:String,required:!0}},emits:["unlocked"],setup(v,{emit:y}){const f=v,m=y,o=n(""),r=n(!1),a=n(""),c=async()=>{if(!o.value){a.value="è¯·è¾“å…¥å¯†ç ";return}r.value=!0,a.value="";try{const t=await fetch(f.encryptedUrl);if(!t.ok)throw new Error("æ— æ³•åŠ è½½åŠ å¯†æ–‡ç« ");const e=await t.arrayBuffer(),l=await g(e,o.value);m("unlocked",l)}catch(t){console.error("è§£å¯†å¤±è´¥:",t),t.message.includes("authentication")?a.value="å¯†ç é”™è¯¯ï¼Œè¯·é‡è¯•":a.value=`è§£å¯†å¤±è´¥: ${t.message}`,o.value=""}finally{r.value=!1}};return(t,e)=>(d(),i("div",h,[s("div",x,[e[2]||(e[2]=s("div",{class:"lock-icon"},"ğŸ”’",-1)),e[3]||(e[3]=s("h2",null,"æ­¤æ–‡ç« éœ€è¦å¯†ç è®¿é—®",-1)),e[4]||(e[4]=s("p",{class:"hint"},"è¿™æ˜¯ä¸€ç¯‡åŠ å¯†æ–‡ç« ï¼Œè¯·è¾“å…¥å¯†ç ä»¥æŸ¥çœ‹å†…å®¹",-1)),s("div",B,[_(s("input",{"onUpdate:modelValue":e[0]||(e[0]=l=>o.value=l),type:"password",placeholder:"è¯·è¾“å…¥å¯†ç ",onKeyup:w(c,["enter"]),disabled:r.value,class:"password-input"},null,40,D),[[k,o.value]]),s("button",{onClick:c,disabled:r.value||!o.value,class:"unlock-button"},p(r.value?"è§£å¯†ä¸­...":"è§£é”"),9,U)]),a.value?(d(),i("div",C,p(a.value),1)):u("",!0),r.value?(d(),i("div",E,e[1]||(e[1]=[s("div",{class:"progress-fill"},null,-1)]))):u("",!0)])]))}},T=b(V,[["__scopeId","data-v-163c5e2d"]]);export{T as default};
