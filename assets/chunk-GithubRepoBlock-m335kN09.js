import{r as p,i as W,f as ot,b as i,o as c,e,l as C,t as g,G as rt,D as lt,F as nt,k as it,y as ct,g as N,h as q}from"./entry-index-SPlK3XI6.js";import{_ as ut}from"./chunk-_plugin-vue_export-helper-DlAUqK2U.js";import"./chunk-mermaid-lib-Cmv1Qdle.js";const dt={key:0,class:"terminal-loader"},vt={key:1,class:"error-slate"},pt=["href"],ht={key:2,class:"repo-card"},ft=["title"],mt={class:"cache-time"},gt=["title"],_t={key:0,class:"rate-time"},bt={class:"flex-layout"},yt={class:"main-info"},kt={class:"repo-header"},xt={class:"owner-chip"},wt={class:"repo-name"},St=["href"],Lt={class:"repo-bio"},Et={class:"repo-meta-strip"},Mt={class:"meta-item star"},At={class:"meta-item fork"},Rt={key:0,class:"meta-item language"},Ct={class:"visual-panel"},It={class:"activity-section"},Dt={class:"heartbeat-container"},$t={viewBox:"0 0 100 20",preserveAspectRatio:"none",class:"heartbeat-svg"},Nt=["d"],Tt=["d"],Gt=["d"],Ot=["d"],Pt={class:"growth-section"},Bt={class:"sparkline"},Ht={viewBox:"0 0 120 30",class:"spark-svg"},Ft=["d"],Zt=["d"],Vt={class:"repo-footer"},Ut={class:"contributors"},zt={class:"contributor-stack"},Yt=["src","title"],jt=["title","aria-label"],Jt={__name:"GithubRepoBlock",props:{repourl:String},setup(Q){const T=Q,r=p(null),y=p([]),f=p([]),w=p(!1),m=p(0),S=p(!0),L=p(!1),k=p(!1),I=p(null),X=a=>{try{const t=new URL(a).pathname.split("/").filter(Boolean);if(t.length>=2)return{owner:t[0],repo:t[1]}}catch{return null}return null},G=()=>{const a={};return q.GitHubToken&&(a.Authorization=`Bearer ${q.GitHubToken}`),a},E=X(T.repourl);E&&(r.value={name:E.repo,owner:{login:E.owner},description:"Syncing repository metadata...",stargazers_count:0,forks_count:0,html_url:T.repourl,created_at:new Date().toISOString()});const Z=(a,t)=>`gh_cache_${a}_${t}`,tt=(a,t,o)=>{localStorage.setItem(Z(a,t),JSON.stringify({timestamp:new Date().getTime(),data:o}))},O=(a,t)=>{const o=localStorage.getItem(Z(a,t));if(!o)return null;try{return JSON.parse(o)}catch{return null}},V=(a,t)=>`gh_etag_${a}_${t}`,et=(a,t)=>localStorage.getItem(V(a,t)),U=(a,t,o)=>{if(o)try{localStorage.setItem(V(a,t),o)}catch{}},P=p(!1),x=p(null),z=a=>!a&&a!==0?"0":a>=1e3?(a/1e3).toFixed(1)+"k":a,Y=W(()=>{if(!r.value)return"";const a=[],t=120,o=30,n=r.value.id||0;new Date(r.value.created_at);const _=u=>Math.abs(Math.sin(n+u)*1e3)%1;for(let u=0;u<=20;u++){const d=u/20*t,h=u/20,b=.3+_(1)*.4,M=8+_(2)*10;let A=1/(1+Math.exp(-M*(h-b)));A=A*.85+h*.15;const B=(_(u)-.5)*2,H=o-(A*(o-10)+5)+B;a.push(`${d},${H}`)}return`M 0,${o} L ${a.join(" L ")} L ${t},${o} Z`}),D=W(()=>{if(!y.value.length)return"M 0,15 L 100,15";const a=Math.max(...y.value,1);return`M ${y.value.map((o,n)=>{const _=n/(y.value.length-1)*100,u=18-o/a*16;return`${_.toFixed(2)},${u.toFixed(2)}`}).join(" L ")}`}),at=async()=>{var u;if(!E){L.value=!0,S.value=!1;return}const{owner:a,repo:t}=E,o=`https://api.github.com/repos/${a}/${t}`,n=O(a,t);n&&(r.value=n.data.repoData,y.value=n.data.commitStats,f.value=n.data.contributors,w.value=n.data.contributorsHasMore,m.value=n.data.contributorsExtraCount,k.value=!0,I.value=new Date(n.timestamp).toLocaleString(),S.value=!1);const _=async(d,h=3)=>{try{const b=await N.get(d,{headers:G()});return b.status===202&&h>0?(await new Promise(M=>setTimeout(M,2e3)),_(d,h-1)):b.data}catch(b){throw b}};try{const d=et(a,t),h=G(),b=d?{"If-None-Match":d,...h}:h,M=N.get(o,{headers:b}),A=d?{"If-None-Match":d,...h}:h,B=N.get(`${o}/contributors`,{params:{per_page:6},headers:A}),H=_(`${o}/stats/commit_activity`),st=await Promise.allSettled([M,H,B]),[R,F,j]=st;if(R.status==="fulfilled"){const s=R.value;if(s.status===200&&s.data)r.value=s.data,U(a,t,s.headers&&(s.headers.etag||s.headers.Etag));else if(s.status===304){const l=O(a,t);l&&(r.value=l.data.repoData,k.value=!0,I.value=new Date(l.timestamp).toLocaleString())}if(s.headers){const l=s.headers["x-ratelimit-remaining"],$=s.headers["x-ratelimit-reset"];l!==void 0&&Number(l)<=0&&(P.value=!0,x.value=$?new Date(Number($)*1e3).toLocaleString():null)}}else{const s=R.reason;if(((u=s==null?void 0:s.response)==null?void 0:u.status)===403){P.value=!0;const v=(s.response.headers||{})["x-ratelimit-reset"];x.value=v?new Date(Number(v)*1e3).toLocaleString():null,k.value||(r.value.description="API Rate Limit Exceeded. Using static data.")}else k.value||(L.value=!0)}if(F.status==="fulfilled"){const s=Array.isArray(F.value)?F.value.slice(-12):[];y.value=s.flatMap(l=>l.days)}if(j.status==="fulfilled"){const s=j.value;if(s.status===200){const v=Array.isArray(s.data)?s.data:[];f.value=v.slice(0,6),U(a,t,s.headers&&(s.headers.etag||s.headers.Etag))}else if(s.status===304){const v=O(a,t);v&&(f.value=v.data.contributors||[])}let l=null;if(s.headers&&s.headers.link)try{const v=await N.get(`${o}/contributors`,{params:{per_page:1},headers:G()}),J=v.headers&&v.headers.link;if(J){const K=J.match(/[?&]page=(\d+)[^>]*>;\s*rel="last"/);K&&(l=parseInt(K[1],10))}}catch{}l!==null?(w.value=l>f.value.length,m.value=Math.max(0,l-f.value.length)):w.value=(f.value&&f.value.length)>=6}R.status==="fulfilled"&&R.value.status===200&&(k.value=!1,tt(a,t,{repoData:r.value,commitStats:y.value,contributors:f.value,contributorsHasMore:w.value,contributorsExtraCount:m.value}))}catch(d){console.error("GitHub API Error:",d),r.value||(L.value=!0)}finally{S.value=!1}};return ot(()=>at()),(a,t)=>(c(),i("div",{class:ct(["repo-embed-container",{"is-loading":S.value,"is-error":L.value}])},[S.value?(c(),i("div",dt,t[0]||(t[0]=[e("div",{class:"cursor"},null,-1),e("span",null,"ANALYZING_CORE_REPOSITORY...",-1)]))):L.value?(c(),i("div",vt,[t[1]||(t[1]=e("div",{class:"error-icon"},"!",-1)),t[2]||(t[2]=e("div",{class:"error-text"},"REPOSITORY_ACCESS_DENIED",-1)),e("a",{href:T.repourl,target:"_blank",class:"emergency-link"},"MANUAL_ACCESS",8,pt)])):(c(),i("div",ht,[t[15]||(t[15]=e("div",{class:"card-accent-line"},null,-1)),k.value?(c(),i("div",{key:0,class:"cache-indicator",title:"Last updated: "+I.value},[t[3]||(t[3]=e("span",{class:"cache-label"},"OFFLINE_CACHE",-1)),e("span",mt,g(I.value),1)],8,ft)):C("",!0),P.value?(c(),i("div",{key:1,class:"rate-indicator",title:x.value?"Rate limit resets: "+x.value:"Rate limited"},[t[4]||(t[4]=e("span",{class:"rate-label"},"RATE_LIMITED",-1)),x.value?(c(),i("span",_t,g(x.value),1)):C("",!0)],8,gt)):C("",!0),e("div",bt,[e("div",yt,[e("header",kt,[e("div",xt,[t[5]||(t[5]=e("span",{class:"prefix"},"@",-1)),rt(g(r.value.owner.login),1)]),e("h3",wt,[e("a",{href:r.value.html_url,target:"_blank"},g(r.value.name),9,St)])]),e("p",Lt,g(r.value.description||"No description provided for this stream."),1),e("div",Et,[e("div",Mt,[t[6]||(t[6]=e("svg",{class:"icon",viewBox:"0 0 16 16",width:"14",height:"14",fill:"currentColor"},[e("path",{d:"M8 .25a.75.75 0 0 1 .673.418l1.882 3.815 4.21.612a.75.75 0 0 1 .416 1.279l-3.046 2.97.719 4.192a.75.75 0 0 1-1.088.791L8 12.347l-3.766 1.98a.75.75 0 0 1-1.088-.79l.72-4.194L.818 6.374a.75.75 0 0 1 .416-1.28l4.21-.611L7.327.668A.75.75 0 0 1 8 .25Z"})],-1)),e("span",null,g(z(r.value.stargazers_count)),1)]),e("div",At,[t[7]||(t[7]=e("svg",{class:"icon",viewBox:"0 0 16 16",width:"14",height:"14",fill:"currentColor"},[e("path",{d:"M5 5.372v.878c0 .414.336.75.75.75h4.5a.75.75 0 0 0 .75-.75v-.878a2.25 2.25 0 1 1 1.5 0v.878a2.25 2.25 0 0 1-2.25 2.25h-1.5v2.128a2.251 2.251 0 1 1-1.5 0V8.5h-1.5A2.25 2.25 0 0 1 3.5 6.25v-.878a2.25 2.25 0 1 1 1.5 0ZM5 3.25a.75.75 0 1 0-1.5 0 .75.75 0 0 0 1.5 0Zm6.75.75a.75.75 0 1 0 0-1.5.75.75 0 0 0 0 1.5Zm-3 10a.75.75 0 1 0 0-1.5.75.75 0 0 0 0 1.5Z"})],-1)),e("span",null,g(z(r.value.forks_count)),1)]),r.value.language?(c(),i("div",Rt,[t[8]||(t[8]=e("span",{class:"lang-dot"},null,-1)),e("span",null,g(r.value.language),1)])):C("",!0)])]),e("div",Ct,[e("div",It,[t[10]||(t[10]=e("div",{class:"section-label"},"COMMIT_PULSE (84D)",-1)),e("div",Dt,[(c(),i("svg",$t,[t[9]||(t[9]=lt('<defs data-v-8b64795b><linearGradient id="line-grad" x1="0%" y1="0%" x2="100%" y2="0%" data-v-8b64795b><stop offset="0%" stop-color="#44d07a" data-v-8b64795b></stop><stop offset="100%" stop-color="#4aa9ff" data-v-8b64795b></stop></linearGradient><linearGradient id="area-grad" x1="0%" y1="0%" x2="0%" y2="100%" data-v-8b64795b><stop offset="0%" stop-color="#44d07a" stop-opacity="0.45" data-v-8b64795b></stop><stop offset="100%" stop-color="#44d07a" stop-opacity="0" data-v-8b64795b></stop></linearGradient><mask id="scan-mask" data-v-8b64795b><rect width="30%" height="100%" x="-30%" fill="white" class="mask-rect" data-v-8b64795b></rect></mask></defs>',1)),e("path",{d:D.value+" L 100,20 L 0,20 Z",fill:"url(#area-grad)",class:"heartbeat-area"},null,8,Nt),e("path",{d:D.value,fill:"none",class:"heartbeat-bg-line"},null,8,Tt),e("path",{d:D.value,fill:"none",class:"heartbeat-line",stroke:"url(#line-grad)"},null,8,Gt),e("path",{d:D.value,fill:"none",class:"heartbeat-scan",stroke:"#fff",mask:"url(#scan-mask)"},null,8,Ot)]))])]),e("div",Pt,[t[13]||(t[13]=e("div",{class:"section-label"},"STAR_MOMENTUM",-1)),e("div",Bt,[(c(),i("svg",Ht,[t[11]||(t[11]=e("defs",null,[e("linearGradient",{id:"star-grad",x1:"0%",y1:"0%",x2:"0%",y2:"100%"},[e("stop",{offset:"0%","stop-color":"#4aa9ff","stop-opacity":"0.35"}),e("stop",{offset:"100%","stop-color":"#4aa9ff","stop-opacity":"0"})])],-1)),e("path",{d:Y.value,fill:"url(#star-grad)",class:"star-area"},null,8,Ft),e("path",{d:Y.value.replace(" L 0,30","").replace(" L 120,30 Z",""),fill:"none",class:"path-curve"},null,8,Zt),t[12]||(t[12]=e("circle",{cx:120,cy:12,r:"2.5",class:"glow-point"},null,-1))]))])])])]),e("footer",Vt,[e("div",Ut,[e("div",zt,[(c(!0),i(nt,null,it(f.value,o=>(c(),i("img",{key:o.id,src:o.avatar_url,title:o.login,class:"contributor-avatar"},null,8,Yt))),128)),w.value?(c(),i("div",{key:0,class:"contributor-extra",title:m.value?"+"+m.value+" more contributors":"more contributors","aria-label":m.value?"+"+m.value+" more contributors":"more contributors",role:"img"},g(m.value?"+"+m.value:"â€¦"),9,jt)):C("",!0)])]),t[14]||(t[14]=e("div",{class:"system-tag"},[e("span",{class:"status-dot"}),e("span",{class:"tag-code"},"DATA_STREAM::ALIVE")],-1))])]))],2))}},Qt=ut(Jt,[["__scopeId","data-v-8b64795b"]]);export{Qt as default};
