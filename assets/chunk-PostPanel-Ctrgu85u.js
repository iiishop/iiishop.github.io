const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/chunk-Post-CyJ5YMGC.js","assets/chunk-mermaid-lib--N4Maba6.js","assets/entry-index-D8c4lH7g.js","assets/asset-index-whA3utIM.css","assets/chunk-_plugin-vue_export-helper-DlAUqK2U.js","assets/asset-Post-C9h82OrA.css"])))=>i.map(i=>d[i]);
import{_ as q}from"./chunk-mermaid-lib--N4Maba6.js";import{r as f,h as u,f as B,n as G,j as I,i as w,v as j,b,o as P,a as F,e as v,w as V,F as k,k as T,c as N,u as Y,d as J,I as K,p as Q,g as X,q as Z,t as ee}from"./entry-index-D8c4lH7g.js";import{g as x}from"./chunk-index-D-nlVayj.js";import{_ as te}from"./chunk-_plugin-vue_export-helper-DlAUqK2U.js";const ae={class:"PostPanel"},oe={class:"pagination"},se=["disabled"],ne=["disabled"],ie=["onClick","disabled"],re=["disabled"],le=["disabled"],ce={__name:"PostPanel",setup(ue){const S=J(()=>q(()=>import("./chunk-Post-CyJ5YMGC.js"),__vite__mapDeps([0,1,2,3,4,5]))),m=f({}),o=f(1),r=f(u.PostsPerPage),d=f(0);f(0);async function C(){const t=Q.markdowns,a={};for(const[e,i]of Object.entries(t))try{if(e.includes("/WaterfallGraph/")||e.includes("\\WaterfallGraph\\")){console.log(`[PostPanel] Skipping WaterfallGraph file: ${e}`);continue}const h=(await X.get(e.startsWith("http")?e:new URL(e,import.meta.url).href)).data,{meta:n}=await Z(h),_=n.tags&&(Array.isArray(n.tags)?n.tags.includes("公告"):n.tags==="公告"),y=n.title&&n.title.toLowerCase()==="about";!_&&!y&&(a[e]=i)}catch(s){console.error(`Failed to check tags for ${e}:`,s),a[e]=i}m.value=a}function p(){if(!u.EnableDynamicPostsPerPage){r.value=u.PostsPerPage;return}const t=document.querySelector(".LeftList .context"),a=document.querySelector(".RightList .context"),e=t?t.offsetHeight:0,i=a?a.offsetHeight:0;if(d.value=Math.max(e,i),console.log("[PostPanel] Sidebar heights:",{leftHeight:e,rightHeight:i,max:d.value}),d.value===0){r.value=u.PostsPerPage;return}const s=document.querySelectorAll(".posts > *");let c=450;if(s.length>0){const _=Array.from(s).reduce((W,$)=>W+$.offsetHeight,0),y=(s.length-1)*16;c=(_+y)/s.length}const h=Math.ceil(d.value/c),n=Math.max(u.PostsPerPage,h);console.log("[PostPanel] Dynamic calculation:",{sidebarHeight:d.value,avgPostHeight:c,calculatedPosts:h,configMin:u.PostsPerPage,finalPostsPerPage:n}),Math.abs(r.value-n)>=1&&(r.value=n,console.log("[PostPanel] Updated posts per page to:",n))}let g=null;function L(){if(typeof ResizeObserver>"u")return;g=new ResizeObserver(()=>{window.resizeTimeout&&clearTimeout(window.resizeTimeout),window.resizeTimeout=setTimeout(()=>{p()},300)});const t=document.querySelector(".LeftList .context"),a=document.querySelector(".RightList .context");t&&g.observe(t),a&&g.observe(a)}B(async()=>{await C(),await G(),setTimeout(()=>{p()},500),setTimeout(()=>{p()},1e3),setTimeout(()=>{p(),L()},1500)}),I(()=>{g&&g.disconnect(),window.resizeTimeout&&clearTimeout(window.resizeTimeout)});const l=w(()=>Math.ceil(Object.keys(m.value).length/r.value)),E=w(()=>{const t=Object.keys(m.value).map(s=>({key:s,...m.value[s]})).sort((s,c)=>new Date(c.date)-new Date(s.date)),a=(o.value-1)*r.value,e=a+r.value,i=t.slice(a,e);return console.log(`Current Page: ${o.value}, Posts per page: ${r.value}, Start: ${a}, End: ${e}`),i});j(r,()=>{o.value>l.value&&(o.value=1)});const z=t=>{t>=1&&t<=l.value&&(o.value=t)},A=()=>{o.value=1},H=()=>{o.value=l.value},M=()=>{o.value<l.value&&(o.value+=1)},O=()=>{o.value>1&&(o.value-=1)};function R(t){t.style.opacity=0,t.style.transform="translateY(30px)"}function U(t,a){const e=t.dataset.index*100;setTimeout(()=>{x.to(t,{opacity:1,y:0,duration:.6,ease:"power2.out",onComplete:a})},e)}function D(t,a){x.to(t,{opacity:0,y:-20,scale:.98,duration:.4,ease:"power2.in",onComplete:a})}return(t,a)=>(P(),b("div",ae,[F(K,{name:"list",tag:"div",class:"posts",onBeforeEnter:R,onEnter:U,onLeave:D,appear:""},{default:V(()=>[(P(!0),b(k,null,T(E.value,(e,i)=>(P(),N(Y(S),{key:e.key,imageUrl:e.imageUrl,markdownUrl:e.key,"data-index":i},null,8,["imageUrl","markdownUrl","data-index"]))),128))]),_:1}),v("div",oe,[v("button",{onClick:A,disabled:o.value===1},"最前页",8,se),v("button",{onClick:O,disabled:o.value===1},"前一页",8,ne),(P(!0),b(k,null,T(l.value,e=>(P(),b("button",{key:e,onClick:i=>z(e),disabled:o.value===e},ee(e),9,ie))),128)),v("button",{onClick:M,disabled:o.value===l.value},"后一页",8,re),v("button",{onClick:H,disabled:o.value===l.value},"最后页",8,le)])]))}},ve=te(ce,[["__scopeId","data-v-65b31f79"]]);export{ve as default};
