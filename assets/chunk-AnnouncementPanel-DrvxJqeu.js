import{C as P,r as m,f as j,b as n,l as c,o as l,e,D as V,F as w,k as f,m as p,p as $,g as z,q as D,y as b,t as v,E as N,G as U}from"./entry-index-YuPeCGrD.js";import{_ as F}from"./chunk-_plugin-vue_export-helper-DlAUqK2U.js";import"./chunk-mermaid-lib-C3SUPDTN.js";const I={key:0,class:"announcement-panel"},L={class:"panel-header"},S={class:"nav-indicators"},T=["onClick","aria-label"],E={class:"announcements-container"},R=["onClick"],q={class:"card-content"},G={class:"card-badge"},O={class:"badge-number"},W={key:0,class:"card-title"},Z={class:"card-meta"},H={key:0,class:"meta-date"},J={key:1,class:"meta-category"},K={key:1,class:"card-preview"},Q={class:"card-actions"},X=["onClick"],Y={class:"nav-controls"},tt=["disabled"],et=["disabled"],st={__name:"AnnouncementPanel",setup(at){const _=P(),r=m(0),i=m([]);async function y(){const o=$.markdowns,t=[];for(const[s,a]of Object.entries(o))try{const h=(await z.get(s.startsWith("http")?s:new URL(s,import.meta.url).href)).data,{meta:u}=await D(h);u.tags&&(Array.isArray(u.tags)?u.tags.includes("公告"):u.tags==="公告")&&t.push({key:s,imageUrl:a.imageUrl,metadata:u})}catch(d){console.error(`Failed to load announcement from ${s}:`,d)}t.sort((s,a)=>{const d=new Date(s.metadata.date||0);return new Date(a.metadata.date||0)-d}),i.value=t}j(()=>{y()});function C(o){return o?o.split(" ")[0]:""}function x(o){const t=o-r.value;return t<0?{"--offset":t,"--z-index":0}:{"--offset":t,"--z-index":i.value.length-o}}function M(o,t){o===r.value?g(t):o>r.value&&k(o)}function g(o){const t=o.key.split("/").filter(d=>d),s=t[t.length-1].replace(".md",""),a=t.length>2?t[1]:null;_.push({name:"PostPage",params:{collection:a,mdName:s}})}function B(){r.value>0&&r.value--}function A(){r.value<i.value.length-1&&r.value++}function k(o){r.value=o}return(o,t)=>i.value.length>0?(l(),n("div",I,[e("div",L,[t[0]||(t[0]=V('<div class="header-icon" data-v-b5b4c2c0><svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-b5b4c2c0><path d="M18 8A6 6 0 1 0 6 8c0 7-3 9-3 9h18s-3-2-3-9Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-v-b5b4c2c0></path><path d="M13.73 21a2 2 0 0 1-3.46 0" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-v-b5b4c2c0></path></svg></div><h2 class="panel-title" data-v-b5b4c2c0>最新公告</h2>',2)),e("div",S,[(l(!0),n(w,null,f(i.value,(s,a)=>(l(),n("button",{key:a,onClick:d=>k(a),class:b(["indicator",{active:r.value===a}]),"aria-label":`查看第${a+1}条公告`},null,10,T))),128))])]),e("div",E,[e("div",{class:"cards-stack",style:p({"--total":i.value.length})},[(l(!0),n(w,null,f(i.value,(s,a)=>(l(),n("div",{key:s.key,class:b(["announcement-card",{"is-active":a===r.value,"is-behind":a>r.value,"is-past":a<r.value}]),style:p(x(a)),onClick:d=>M(a,s)},[s.imageUrl?(l(),n("div",{key:0,class:"card-image-bg",style:p({backgroundImage:`url(${s.imageUrl})`})},t[1]||(t[1]=[e("div",{class:"image-overlay"},null,-1)]),4)):c("",!0),e("div",q,[e("div",G,[t[2]||(t[2]=e("span",{class:"badge-text"},"公告",-1)),e("span",O,"#"+v(i.value.length-a),1)]),s.metadata.title?(l(),n("h3",W,v(s.metadata.title),1)):c("",!0),e("div",Z,[s.metadata.date?(l(),n("div",H,[t[3]||(t[3]=e("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[e("rect",{x:"3",y:"6",width:"18",height:"15",rx:"2",stroke:"currentColor","stroke-width":"2"}),e("path",{d:"M3 10h18M7 3v4M17 3v4",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round"})],-1)),e("span",null,v(C(s.metadata.date)),1)])):c("",!0),s.metadata.categories?(l(),n("div",J,[t[4]||(t[4]=e("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[e("path",{d:"M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"}),e("circle",{cx:"7",cy:"7",r:"1",fill:"currentColor"})],-1)),e("span",null,v(s.metadata.categories[s.metadata.categories.length-1]),1)])):c("",!0)]),s.metadata.pre?(l(),n("p",K,v(s.metadata.pre),1)):c("",!0),e("div",Q,[e("button",{class:"action-btn primary",onClick:N(d=>g(s),["stop"])},t[5]||(t[5]=[U(" 查看详情 "),e("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[e("path",{d:"M5 12h14M12 5l7 7-7 7",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1)]),8,X)])]),t[6]||(t[6]=e("div",{class:"card-corner"},null,-1))],14,R))),128))],4),e("div",Y,[e("button",{class:"nav-btn prev",onClick:B,disabled:r.value===0,"aria-label":"上一条公告"},t[7]||(t[7]=[e("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[e("path",{d:"M15 18l-6-6 6-6",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1)]),8,tt),e("button",{class:"nav-btn next",onClick:A,disabled:r.value===i.value.length-1,"aria-label":"下一条公告"},t[8]||(t[8]=[e("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[e("path",{d:"M9 18l6-6-6-6",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1)]),8,et)])])])):c("",!0)}},lt=F(st,[["__scopeId","data-v-b5b4c2c0"]]);export{lt as default};
