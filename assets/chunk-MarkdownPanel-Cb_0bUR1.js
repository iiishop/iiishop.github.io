const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/chunk-SteamGameBlock-B0Dvfl95.js","assets/entry-index-YuPeCGrD.js","assets/chunk-mermaid-lib-C3SUPDTN.js","assets/asset-index-BzCrfPwL.css","assets/chunk-color-thief-DF3QbzqH.js","assets/chunk-_plugin-vue_export-helper-DlAUqK2U.js","assets/asset-SteamGameBlock-B-ltQF1U.css","assets/chunk-BangumiBlock-Cin0cg06.js","assets/asset-BangumiBlock-CZgwujlY.css","assets/chunk-BilibiliVideoBlock-Dgs8dwTO.js","assets/asset-BilibiliVideoBlock-DE3SKqHY.css","assets/chunk-GithubRepoBlock-BC8Q0YiX.js","assets/asset-GithubRepoBlock-CkND9FTr.css","assets/chunk-XiaohongshuNoteBlock-BPl_sl6o.js","assets/asset-XiaohongshuNoteBlock-C8nWHP7E.css","assets/chunk-CarouselBlock-BZL4qynv.js","assets/asset-CarouselBlock-B-7UFdv-.css"])))=>i.map(i=>d[i]);
import{an as I,_ as f}from"./chunk-mermaid-lib-C3SUPDTN.js";import{r as v,i as y,h as O,v as le,f as re,j as ie,x as ce,b as u,o as m,e as s,l as p,a as k,m as q,t as w,w as B,G as U,F as de,k as ue,T as me,g as he,q as ve,n as D,d as C}from"./entry-index-YuPeCGrD.js";import{f as pe}from"./chunk-index-CsxCzjxM.js";import{m as ge}from"./chunk-MarkdownRenender-COWchc2q.js";import{r as _e}from"./chunk-DynamicComponentRenderer-DsRUfL1W.js";import fe from"./chunk-IconCategory-DmvOIfgZ.js";import ye from"./chunk-IconDate-CUMpmgQT.js";import ke from"./chunk-GiscusComments-kIa8gVUn.js";import{_ as we}from"./chunk-_plugin-vue_export-helper-DlAUqK2U.js";const Ce={class:"image-container"},be=["src"],Me={class:"overlay"},xe={class:"header-content"},Te={class:"post-title"},$e={class:"meta-info"},Pe={key:0,class:"category-panel"},Ae={key:1,class:"meta-divider"},Ee={key:2,class:"date-panel"},Se={key:0,class:"article-stats"},Le={class:"stat-item"},Ie={class:"stat-content"},Be={class:"stat-value"},De={class:"stat-item"},Re={class:"stat-content"},Ve={class:"stat-value"},He={key:0,class:"stat-divider"},Ne={key:1,class:"stat-item stat-tags"},Ge={class:"stat-content"},Oe={class:"tags-container"},qe=["innerHTML"],Ue={key:1,class:"comments-section"},ze={__name:"MarkdownPanel",props:{markdownUrl:{type:String,required:!0},decryptedContent:{type:String,default:null}},setup(z){const F=C(()=>f(()=>import("./chunk-SteamGameBlock-B0Dvfl95.js"),__vite__mapDeps([0,1,2,3,4,5,6]))),j=C(()=>f(()=>import("./chunk-BangumiBlock-Cin0cg06.js"),__vite__mapDeps([7,1,2,3,4,5,8]))),K=C(()=>f(()=>import("./chunk-BilibiliVideoBlock-Dgs8dwTO.js"),__vite__mapDeps([9,1,2,3,5,10]))),Y=C(()=>f(()=>import("./chunk-GithubRepoBlock-BC8Q0YiX.js"),__vite__mapDeps([11,1,2,3,5,12]))),W=C(()=>f(()=>import("./chunk-XiaohongshuNoteBlock-BPl_sl6o.js"),__vite__mapDeps([13,1,2,3,5,14]))),X=C(()=>f(()=>import("./chunk-CarouselBlock-BZL4qynv.js"),__vite__mapDeps([15,5,1,2,3,16]))),b=z,o=v({}),A=v(""),x=v(null),E=v(null),R=v(null),V=v(null),S=v(0),H=v(!1),T=v({h:210,s:70,l:55}),M=v({h:220,s:65,l:50}),$=v({wordCount:0,readingTime:0}),J=y(()=>{var a,e,t;return((a=O.Giscus)==null?void 0:a.enabled)&&((t=(e=O.Giscus)==null?void 0:e.markdownPanel)==null?void 0:t.enabled)}),Q=y(()=>o.value.title||b.markdownUrl),Z=y(()=>{const{h:a,s:e,l:t}=T.value,{h:n,s:l,l:i}=M.value;return{"--primary-hue":a,"--primary-sat":e+"%","--primary-light":t+"%","--accent-hue":n,"--accent-sat":l+"%","--accent-light":i+"%","--primary-color":`hsl(${a}, ${e}%, ${t}%)`,"--primary-light-color":`hsl(${a}, ${e}%, ${Math.min(t+15,85)}%)`,"--primary-dark-color":`hsl(${a}, ${e}%, ${Math.max(t-15,20)})`,"--accent-color":`hsl(${n}, ${l}%, ${i}%)`,"--gradient":`linear-gradient(135deg, hsl(${a}, ${e}%, ${t}%) 0%, hsl(${n}, ${l}%, ${i}%) 100%)`}}),ee=a=>{const t=a.replace(/<[^>]*>/g,"").replace(/\s+/g,"").length,n=Math.ceil(t/300);$.value={wordCount:t,readingTime:n}},te=()=>{var n;const a=(n=R.value)==null?void 0:n.querySelector(".header-image"),e=V.value;if(!a||!e)return;const t=e.getContext("2d");e.width=a.width,e.height=a.height;try{t.drawImage(a,0,0,e.width,e.height);const l=t.getImageData(0,0,e.width,e.height).data,i=new Map;for(let r=0;r<l.length;r+=40){const h=l[r],d=l[r+1],c=l[r+2];if(l[r+3]<128||h>240&&d>240&&c>240||h<15&&d<15&&c<15)continue;const g=ae(h,d,c);if(g.s>20){const P=`${Math.round(g.h/10)*10}-${Math.round(g.s/10)*10}`;i.set(P,(i.get(P)||0)+1)}}if(i.size>0){const r=Array.from(i.entries()).sort((_,g)=>g[1]-_[1]),[h]=r[0],[d,c]=h.split("-").map(Number);if(T.value={h:d,s:Math.min(c+10,80),l:55},r.length>1){const[_]=r[1],[g,P]=_.split("-").map(Number);M.value={h:g,s:Math.min(P+5,75),l:50}}else M.value={h:(d+30)%360,s:Math.min(c+5,75),l:50}}}catch(l){console.warn("æ— æ³•æå–å›¾ç‰‡é¢œè‰²ï¼Œä½¿ç”¨é»˜è®¤é…è‰²:",l),T.value={h:210,s:70,l:55},M.value={h:220,s:65,l:50}}},ae=(a,e,t)=>{a/=255,e/=255,t/=255;const n=Math.max(a,e,t),l=Math.min(a,e,t);let i,r,h=(n+l)/2;if(n===l)i=r=0;else{const d=n-l;switch(r=h>.5?d/(2-n-l):d/(n+l),n){case a:i=((e-t)/d+(e<t?6:0))/6;break;case e:i=((t-a)/d+2)/6;break;case t:i=((a-e)/d+4)/6;break}}return{h:Math.round(i*360),s:Math.round(r*100),l:Math.round(h*100)}},N=()=>{if(!E.value||!x.value)return;const a=x.value.offsetTop,e=x.value.scrollHeight,t=window.innerHeight,n=window.scrollY,l=n-a,i=e-t,r=Math.min(Math.max(l/i*100,0),100);S.value=r,H.value=n>500},oe=()=>{window.scrollTo({top:0,behavior:"smooth"})},G=async(a,e=null)=>{try{let t;e?(t=e,console.log("ä½¿ç”¨è§£å¯†åçš„å†…å®¹")):t=(await he.get(a)).data;const{body:n}=pe(t),{meta:l}=await ve(t);o.value=l,o.value.img&&(o.value.img=`/Posts/Images/${o.value.img}`);const i=new Date(o.value.date),r=i.getHours();o.value.date=i.toLocaleDateString().replace(/\//g,"æœˆ").replace("æœˆ","å¹´")+"æ—¥",r<6?o.value.date+=" å‡Œæ™¨":r<12?o.value.date+=" ä¸Šåˆ":r<18?o.value.date+=" ä¸‹åˆ":o.value.date+=" æ™šä¸Š",A.value=ge.render(n),ee(A.value),await D();const h=E.value;if(h&&_e(h,{steamgameblock:F,bangumiblock:j,bilibilivideoblock:K,githubrepoblock:Y,xiaohongshunoteblock:W,carouselblock:X}),await D(),typeof I<"u")try{I.mermaidAPI.reset(),await I.run({nodes:document.querySelectorAll(".mermaid")}),await D(),document.querySelectorAll(".mermaid svg").forEach(c=>{if(c.removeAttribute("width"),c.removeAttribute("height"),c.style.width="100%",c.style.height="400px",c.style.maxWidth="100%",c.style.maxHeight="400px",c.style.display="block",c.style.margin="0 auto",c.getAttribute("style")){const _=c.getAttribute("style");c.setAttribute("style",_.replace(/max-width:\s*\d+px;?/gi,""))}})}catch(d){console.warn("Mermaid rendering failed:",d)}}catch(t){console.error("Error fetching or parsing markdown file:",t)}};le(()=>[b.markdownUrl,b.decryptedContent],([a,e])=>{G(a,e),S.value=0,T.value={h:210,s:70,l:55},M.value={h:220,s:65,l:50}},{immediate:!0}),re(()=>{G(b.markdownUrl,b.decryptedContent),window.addEventListener("scroll",N)}),ie(()=>{window.removeEventListener("scroll",N)});const L=y(()=>o.value.categories&&o.value.categories.length>0?o.value.categories[o.value.categories.length-1]:""),se=y(()=>o.value.categories&&o.value.categories.length>0?{name:"CategoryPage",params:{fullPath:o.value.categories.join("/")}}:"#"),ne=y(()=>({name:"ArchivePage"}));return(a,e)=>{const t=ce("router-link");return m(),u("div",{class:"MarkdownPanel",ref_key:"panelRef",ref:x,style:q(Z.value)},[s("div",{class:"reading-progress",style:q({width:S.value+"%"})},null,4),s("div",{class:"post-header",ref_key:"headerRef",ref:R},[s("div",Ce,[o.value.img?(m(),u("img",{key:0,src:o.value.img,alt:"Post Image",class:"header-image",crossorigin:"anonymous",onLoad:te},null,40,be)):p("",!0),s("canvas",{ref_key:"colorCanvas",ref:V,style:{display:"none"}},null,512),s("div",Me,[s("div",xe,[s("h1",Te,w(o.value.title),1),s("div",$e,[L.value?(m(),u("div",Pe,[k(fe,{style:{width:"1rem",height:"1rem"}}),k(t,{to:se.value},{default:B(()=>[U(w(L.value),1)]),_:1},8,["to"])])):p("",!0),L.value&&o.value.date?(m(),u("span",Ae,"â€¢")):p("",!0),o.value.date?(m(),u("div",Ee,[k(ye,{style:{width:"1rem",height:"1rem"}}),k(t,{to:ne.value},{default:B(()=>[U(w(o.value.date),1)]),_:1},8,["to"])])):p("",!0)])])])])],512),$.value.wordCount>0?(m(),u("div",Se,[s("div",Le,[s("div",Ie,[e[0]||(e[0]=s("span",{class:"stat-label"},"å­—æ•°",-1)),s("span",Be,w($.value.wordCount.toLocaleString()),1)])]),e[3]||(e[3]=s("div",{class:"stat-divider"},null,-1)),s("div",De,[s("div",Re,[e[1]||(e[1]=s("span",{class:"stat-label"},"é˜…è¯»æ—¶é—´",-1)),s("span",Ve,w($.value.readingTime)+" åˆ†é’Ÿ",1)])]),o.value.tags&&o.value.tags.length>0?(m(),u("div",He)):p("",!0),o.value.tags&&o.value.tags.length>0?(m(),u("div",Ne,[s("div",Ge,[e[2]||(e[2]=s("span",{class:"stat-label"},"æ ‡ç­¾",-1)),s("div",Oe,[(m(!0),u(de,null,ue(o.value.tags,n=>(m(),u("span",{key:n,class:"tag"},w(n),1))),128))])])])):p("",!0)])):p("",!0),s("article",{class:"post-content markdown",ref_key:"contentRef",ref:E},[s("div",{innerHTML:A.value},null,8,qe)],512),J.value?(m(),u("div",Ue,[e[4]||(e[4]=s("div",{class:"comments-header"},[s("h2",{class:"comments-title"},"ğŸ’¬ è¯„è®ºåŒº"),s("p",{class:"comments-subtitle"},"æ¬¢è¿ç•™ä¸‹ä½ çš„æƒ³æ³•å’Œåé¦ˆ")],-1)),k(ke,{"component-type":"markdown",term:Q.value,"emphasize-reactions":!0},null,8,["term"])])):p("",!0),k(me,{name:"fade"},{default:B(()=>[H.value?(m(),u("button",{key:0,class:"back-to-top",onClick:oe},e[5]||(e[5]=[s("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[s("path",{d:"M12 19V5M5 12l7-7 7 7"})],-1)]))):p("",!0)]),_:1})],4)}}},et=we(ze,[["__scopeId","data-v-806a6a6f"]]);export{et as default};
