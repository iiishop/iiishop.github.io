import{r as u,f as O,j as S,b as l,o as r,e as s,C as I,N as B,F as M,m as T,x as b,I as E,t as P}from"./entry-index-Bg11hsaB.js";import{_ as $}from"./chunk-_plugin-vue_export-helper-DlAUqK2U.js";import"./chunk-mermaid-lib-PTTmCi0X.js";const q={class:"toc-header"},H=["aria-label"],N={key:0,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},D={key:1,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},F={class:"toc-nav"},L={key:0,class:"toc-list"},j=["href","onClick"],z={class:"toc-text"},A={key:1,class:"toc-empty"},R={__name:"TOCPanel",props:{contentSelector:{type:String,default:".post-content.markdown"}},setup(k,{expose:x}){const m=k,i=u([]),d=u(""),a=u(!1),c=u(null),v=u(null),p=()=>{const o=document.querySelector(m.contentSelector);if(!o)return;const e=o.querySelectorAll("h2, h3, h4"),t=[];e.forEach((n,f)=>{const C=parseInt(n.tagName.substring(1)),y=n.textContent.trim(),_=n.id||`heading-${f}`;n.id||(n.id=_),t.push({id:_,text:y,level:C,element:n})}),i.value=t,w()},w=()=>{if(c.value&&c.value.disconnect(),i.value.length===0)return;const o={rootMargin:"-80px 0px -80% 0px",threshold:0};c.value=new IntersectionObserver(e=>{e.forEach(t=>{t.isIntersecting&&(d.value=t.target.id)})},o),i.value.forEach(e=>{e.element&&c.value.observe(e.element)})},h=o=>{const e=document.getElementById(o);if(e){const f=e.getBoundingClientRect().top+window.pageYOffset-80;window.scrollTo({top:f,behavior:"smooth"}),d.value=o}},g=()=>{const o=document.querySelector(m.contentSelector);if(!o){setTimeout(g,500);return}v.value=new MutationObserver(()=>{p()}),v.value.observe(o,{childList:!0,subtree:!0}),p()};return O(()=>{g()}),S(()=>{c.value&&c.value.disconnect(),v.value&&v.value.disconnect()}),x({extractTOC:p,scrollToHeading:h}),(o,e)=>(r(),l("div",{class:b(["toc-panel",{"toc-collapsed":a.value}])},[s("div",q,[e[3]||(e[3]=s("h3",{class:"toc-title"},"目录",-1)),s("button",{class:"toc-toggle",onClick:e[0]||(e[0]=t=>a.value=!a.value),"aria-label":a.value?"展开目录":"收起目录"},[a.value?(r(),l("svg",N,e[1]||(e[1]=[s("path",{d:"M19 9l-7 7-7-7"},null,-1)]))):(r(),l("svg",D,e[2]||(e[2]=[s("path",{d:"M19 15l-7-7-7 7"},null,-1)])))],8,H)]),I(s("nav",F,[i.value.length>0?(r(),l("ul",L,[(r(!0),l(M,null,T(i.value,t=>(r(),l("li",{key:t.id,class:b(["toc-item",`toc-level-${t.level}`,{"toc-active":d.value===t.id}])},[s("a",{href:`#${t.id}`,onClick:E(n=>h(t.id),["prevent"]),class:"toc-link"},[e[4]||(e[4]=s("span",{class:"toc-indicator"},null,-1)),s("span",z,P(t.text),1)],8,j)],2))),128))])):(r(),l("div",A,e[5]||(e[5]=[s("p",null,"暂无目录",-1)])))],512),[[B,!a.value]])],2))}},G=$(R,[["__scopeId","data-v-c985b334"]]);export{G as default};
