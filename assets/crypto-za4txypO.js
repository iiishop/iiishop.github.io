async function a(r,t){const n=new TextEncoder().encode(r),c=await crypto.subtle.importKey("raw",n,"PBKDF2",!1,["deriveBits","deriveKey"]);return await crypto.subtle.deriveKey({name:"PBKDF2",salt:t,iterations:1e5,hash:"SHA-256"},c,{name:"AES-GCM",length:256},!1,["decrypt"])}async function l(r,t){try{const e=new Uint8Array(r);if(e.length<28)throw new Error("加密数据格式无效");const n=e.slice(0,16),c=e.slice(16,28),o=e.slice(28),s=await a(t,n),i=await crypto.subtle.decrypt({name:"AES-GCM",iv:c,tagLength:128},s,o);return new TextDecoder("utf-8").decode(i)}catch(e){throw console.error("解密错误:",e),e.name==="OperationError"?new Error("密码错误或文件已损坏 (authentication failed)"):e}}function f(r,t,e){return e[t]?e[t].includes(r):!1}export{l as d,f as i};
