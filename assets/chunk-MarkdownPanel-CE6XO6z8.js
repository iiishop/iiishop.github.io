const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/chunk-SteamGameBlock-CG7zfMrP.js","assets/entry-index-CC0immY_.js","assets/chunk-mermaid-lib-PTTmCi0X.js","assets/asset-index-DQTw5x8l.css","assets/chunk-color-thief-DF3QbzqH.js","assets/chunk-_plugin-vue_export-helper-DlAUqK2U.js","assets/asset-SteamGameBlock-B-ltQF1U.css","assets/chunk-BangumiBlock-DS0oJxN_.js","assets/asset-BangumiBlock-CZgwujlY.css","assets/chunk-BilibiliVideoBlock-_ADmA9Nr.js","assets/asset-BilibiliVideoBlock-DE3SKqHY.css","assets/chunk-GithubRepoBlock-D-tqweO0.js","assets/asset-GithubRepoBlock-CkND9FTr.css","assets/chunk-XiaohongshuNoteBlock-BAmoTW4Y.js","assets/asset-XiaohongshuNoteBlock-C8nWHP7E.css"])))=>i.map(i=>d[i]);
import{an as L,_ as b}from"./chunk-mermaid-lib-PTTmCi0X.js";import{r as h,i as f,h as G,A as ne,f as le,j as re,B as ie,b as u,o as m,e as s,q as p,a as y,l as O,t as w,w as I,y as U,F as ce,m as de,G as ue,g as me,p as he,n as B,d as M}from"./entry-index-CC0immY_.js";import{f as ve}from"./chunk-index-EUBHsC4_.js";import{m as pe}from"./chunk-MarkdownRenender-PQRWQmix.js";import{r as ge}from"./chunk-DynamicComponentRenderer-DqUUpADN.js";import _e from"./chunk-IconCategory-85A7EGld.js";import fe from"./chunk-IconDate-D99_p4G3.js";import ye from"./chunk-GiscusComments-CyEJZ_TR.js";import{_ as we}from"./chunk-_plugin-vue_export-helper-DlAUqK2U.js";const ke={class:"image-container"},Ce=["src"],be={class:"overlay"},Me={class:"header-content"},xe={class:"post-title"},Te={class:"meta-info"},$e={key:0,class:"category-panel"},Pe={key:1,class:"meta-divider"},Se={key:2,class:"date-panel"},Ae={key:0,class:"article-stats"},Ee={class:"stat-item"},Le={class:"stat-content"},Ie={class:"stat-value"},Be={class:"stat-item"},De={class:"stat-content"},Re={class:"stat-value"},Ve={key:0,class:"stat-divider"},He={key:1,class:"stat-item stat-tags"},Ne={class:"stat-content"},qe={class:"tags-container"},Ge=["innerHTML"],Oe={key:1,class:"comments-section"},Ue={__name:"MarkdownPanel",props:{markdownUrl:{type:String,required:!0},decryptedContent:{type:String,default:null}},setup(z){const F=M(()=>b(()=>import("./chunk-SteamGameBlock-CG7zfMrP.js"),__vite__mapDeps([0,1,2,3,4,5,6]))),j=M(()=>b(()=>import("./chunk-BangumiBlock-DS0oJxN_.js"),__vite__mapDeps([7,1,2,3,4,5,8]))),K=M(()=>b(()=>import("./chunk-BilibiliVideoBlock-_ADmA9Nr.js"),__vite__mapDeps([9,1,2,3,5,10]))),Y=M(()=>b(()=>import("./chunk-GithubRepoBlock-D-tqweO0.js"),__vite__mapDeps([11,1,2,3,5,12]))),W=M(()=>b(()=>import("./chunk-XiaohongshuNoteBlock-BAmoTW4Y.js"),__vite__mapDeps([13,1,2,3,5,14]))),k=z,o=h({}),S=h(""),x=h(null),D=h(null),R=h(null),V=h(null),A=h(0),H=h(!1),T=h({h:210,s:70,l:55}),C=h({h:220,s:65,l:50}),$=h({wordCount:0,readingTime:0}),X=f(()=>{var a,e,t;return((a=G.Giscus)==null?void 0:a.enabled)&&((t=(e=G.Giscus)==null?void 0:e.markdownPanel)==null?void 0:t.enabled)}),J=f(()=>o.value.title||k.markdownUrl),Q=f(()=>{const{h:a,s:e,l:t}=T.value,{h:n,s:l,l:i}=C.value;return{"--primary-hue":a,"--primary-sat":e+"%","--primary-light":t+"%","--accent-hue":n,"--accent-sat":l+"%","--accent-light":i+"%","--primary-color":`hsl(${a}, ${e}%, ${t}%)`,"--primary-light-color":`hsl(${a}, ${e}%, ${Math.min(t+15,85)}%)`,"--primary-dark-color":`hsl(${a}, ${e}%, ${Math.max(t-15,20)})`,"--accent-color":`hsl(${n}, ${l}%, ${i}%)`,"--gradient":`linear-gradient(135deg, hsl(${a}, ${e}%, ${t}%) 0%, hsl(${n}, ${l}%, ${i}%) 100%)`}}),Z=a=>{const t=a.replace(/<[^>]*>/g,"").replace(/\s+/g,"").length,n=Math.ceil(t/300);$.value={wordCount:t,readingTime:n}},ee=()=>{var n;const a=(n=R.value)==null?void 0:n.querySelector(".header-image"),e=V.value;if(!a||!e)return;const t=e.getContext("2d");e.width=a.width,e.height=a.height;try{t.drawImage(a,0,0,e.width,e.height);const l=t.getImageData(0,0,e.width,e.height).data,i=new Map;for(let r=0;r<l.length;r+=40){const v=l[r],d=l[r+1],c=l[r+2];if(l[r+3]<128||v>240&&d>240&&c>240||v<15&&d<15&&c<15)continue;const g=te(v,d,c);if(g.s>20){const P=`${Math.round(g.h/10)*10}-${Math.round(g.s/10)*10}`;i.set(P,(i.get(P)||0)+1)}}if(i.size>0){const r=Array.from(i.entries()).sort((_,g)=>g[1]-_[1]),[v]=r[0],[d,c]=v.split("-").map(Number);if(T.value={h:d,s:Math.min(c+10,80),l:55},r.length>1){const[_]=r[1],[g,P]=_.split("-").map(Number);C.value={h:g,s:Math.min(P+5,75),l:50}}else C.value={h:(d+30)%360,s:Math.min(c+5,75),l:50}}}catch(l){console.warn("æ— æ³•æå–å›¾ç‰‡é¢œè‰²ï¼Œä½¿ç”¨é»˜è®¤é…è‰²:",l),T.value={h:210,s:70,l:55},C.value={h:220,s:65,l:50}}},te=(a,e,t)=>{a/=255,e/=255,t/=255;const n=Math.max(a,e,t),l=Math.min(a,e,t);let i,r,v=(n+l)/2;if(n===l)i=r=0;else{const d=n-l;switch(r=v>.5?d/(2-n-l):d/(n+l),n){case a:i=((e-t)/d+(e<t?6:0))/6;break;case e:i=((t-a)/d+2)/6;break;case t:i=((a-e)/d+4)/6;break}}return{h:Math.round(i*360),s:Math.round(r*100),l:Math.round(v*100)}},N=()=>{if(!D.value||!x.value)return;const a=x.value.offsetTop,e=x.value.scrollHeight,t=window.innerHeight,n=window.scrollY,l=n-a,i=e-t,r=Math.min(Math.max(l/i*100,0),100);A.value=r,H.value=n>500},ae=()=>{window.scrollTo({top:0,behavior:"smooth"})},q=async(a,e=null)=>{try{let t;e?(t=e,console.log("ä½¿ç”¨è§£å¯†åçš„å†…å®¹")):t=(await me.get(a)).data;const{body:n}=ve(t),{meta:l}=await he(t);o.value=l,o.value.img&&(o.value.img=`/Posts/Images/${o.value.img}`);const i=new Date(o.value.date),r=i.getHours();o.value.date=i.toLocaleDateString().replace(/\//g,"æœˆ").replace("æœˆ","å¹´")+"æ—¥",r<6?o.value.date+=" å‡Œæ™¨":r<12?o.value.date+=" ä¸Šåˆ":r<18?o.value.date+=" ä¸‹åˆ":o.value.date+=" æ™šä¸Š",S.value=pe.render(n),Z(S.value),await B();const v=document.querySelector(".post-content.markdown");if(ge(v,{steamgameblock:F,bangumiblock:j,bilibilivideoblock:K,githubrepoblock:Y,xiaohongshunoteblock:W}),await B(),typeof L<"u")try{L.mermaidAPI.reset(),await L.run({nodes:document.querySelectorAll(".mermaid")}),await B(),document.querySelectorAll(".mermaid svg").forEach(c=>{if(c.removeAttribute("width"),c.removeAttribute("height"),c.style.width="100%",c.style.height="400px",c.style.maxWidth="100%",c.style.maxHeight="400px",c.style.display="block",c.style.margin="0 auto",c.getAttribute("style")){const _=c.getAttribute("style");c.setAttribute("style",_.replace(/max-width:\s*\d+px;?/gi,""))}})}catch(d){console.warn("Mermaid rendering failed:",d)}}catch(t){console.error("Error fetching or parsing markdown file:",t)}};ne(()=>[k.markdownUrl,k.decryptedContent],([a,e])=>{q(a,e),A.value=0,T.value={h:210,s:70,l:55},C.value={h:220,s:65,l:50}},{immediate:!0}),le(()=>{q(k.markdownUrl,k.decryptedContent),window.addEventListener("scroll",N)}),re(()=>{window.removeEventListener("scroll",N)});const E=f(()=>o.value.categories&&o.value.categories.length>0?o.value.categories[o.value.categories.length-1]:""),oe=f(()=>o.value.categories&&o.value.categories.length>0?{name:"CategoryPage",params:{fullPath:o.value.categories.join("/")}}:"#"),se=f(()=>({name:"ArchivePage"}));return(a,e)=>{const t=ie("router-link");return m(),u("div",{class:"MarkdownPanel",ref_key:"panelRef",ref:x,style:O(Q.value)},[s("div",{class:"reading-progress",style:O({width:A.value+"%"})},null,4),s("div",{class:"post-header",ref_key:"headerRef",ref:R},[s("div",ke,[o.value.img?(m(),u("img",{key:0,src:o.value.img,alt:"Post Image",class:"header-image",crossorigin:"anonymous",onLoad:ee},null,40,Ce)):p("",!0),s("canvas",{ref_key:"colorCanvas",ref:V,style:{display:"none"}},null,512),s("div",be,[s("div",Me,[s("h1",xe,w(o.value.title),1),s("div",Te,[E.value?(m(),u("div",$e,[y(_e,{style:{width:"1rem",height:"1rem"}}),y(t,{to:oe.value},{default:I(()=>[U(w(E.value),1)]),_:1},8,["to"])])):p("",!0),E.value&&o.value.date?(m(),u("span",Pe,"â€¢")):p("",!0),o.value.date?(m(),u("div",Se,[y(fe,{style:{width:"1rem",height:"1rem"}}),y(t,{to:se.value},{default:I(()=>[U(w(o.value.date),1)]),_:1},8,["to"])])):p("",!0)])])])])],512),$.value.wordCount>0?(m(),u("div",Ae,[s("div",Ee,[s("div",Le,[e[0]||(e[0]=s("span",{class:"stat-label"},"å­—æ•°",-1)),s("span",Ie,w($.value.wordCount.toLocaleString()),1)])]),e[3]||(e[3]=s("div",{class:"stat-divider"},null,-1)),s("div",Be,[s("div",De,[e[1]||(e[1]=s("span",{class:"stat-label"},"é˜…è¯»æ—¶é—´",-1)),s("span",Re,w($.value.readingTime)+" åˆ†é’Ÿ",1)])]),o.value.tags&&o.value.tags.length>0?(m(),u("div",Ve)):p("",!0),o.value.tags&&o.value.tags.length>0?(m(),u("div",He,[s("div",Ne,[e[2]||(e[2]=s("span",{class:"stat-label"},"æ ‡ç­¾",-1)),s("div",qe,[(m(!0),u(ce,null,de(o.value.tags,n=>(m(),u("span",{key:n,class:"tag"},w(n),1))),128))])])])):p("",!0)])):p("",!0),s("article",{class:"post-content markdown",ref_key:"contentRef",ref:D},[s("div",{innerHTML:S.value},null,8,Ge)],512),X.value?(m(),u("div",Oe,[e[4]||(e[4]=s("div",{class:"comments-header"},[s("h2",{class:"comments-title"},"ğŸ’¬ è¯„è®ºåŒº"),s("p",{class:"comments-subtitle"},"æ¬¢è¿ç•™ä¸‹ä½ çš„æƒ³æ³•å’Œåé¦ˆ")],-1)),y(ye,{"component-type":"markdown",term:J.value,"emphasize-reactions":!0},null,8,["term"])])):p("",!0),y(ue,{name:"fade"},{default:I(()=>[H.value?(m(),u("button",{key:0,class:"back-to-top",onClick:ae},e[5]||(e[5]=[s("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[s("path",{d:"M12 19V5M5 12l7-7 7 7"})],-1)]))):p("",!0)]),_:1})],4)}}},Ze=we(Ue,[["__scopeId","data-v-2da3e4db"]]);export{Ze as default};
