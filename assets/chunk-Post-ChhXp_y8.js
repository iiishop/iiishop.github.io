const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/chunk-Tag--O27YR8u.js","assets/entry-index-DzRKx3tS.js","assets/chunk-mermaid-lib-BuZcN1zc.js","assets/asset-index-whA3utIM.css","assets/chunk-_plugin-vue_export-helper-DlAUqK2U.js","assets/asset-Tag-C0RPMPKw.css","assets/chunk-IconCategory-Cq-urWfK.js","assets/chunk-IconDate-pzOQPdhw.js"])))=>i.map(i=>d[i]);
import{_ as A}from"./chunk-mermaid-lib-BuZcN1zc.js";import{r as h,i as C,f as ut,C as mt,j as ht,x as vt,b as r,o as i,e as a,c as X,l as w,m as u,u as I,y as gt,F as g,k as p,t as M,a as P,d as E,w as F,T as pt,H as ft,g as yt,q as _t}from"./entry-index-DzRKx3tS.js";import{_ as wt}from"./chunk-_plugin-vue_export-helper-DlAUqK2U.js";const T="/assets/asset-loading-4bFnOtMK.gif",kt={class:"post-wrapper"},xt={class:"image-border-frame"},Mt=["src"],Pt={class:"content-panel"},Ct={key:0,class:"content-wrapper"},It={class:"title-text"},Tt={class:"pre-text"},bt={key:1,class:"placeholder-decoration"},Rt={class:"ornamental-pattern"},Ut={class:"pattern-center"},At={class:"floating-accents"},Et={class:"meta-sidebar"},Ft={class:"meta-list"},zt={key:0,class:"meta-item category-row"},Lt={class:"meta-icon-wrapper"},St={class:"link-text"},$t={key:1,class:"meta-item date-row"},Wt={class:"meta-icon-wrapper"},Bt={class:"link-text"},Dt={class:"tags-container"},Vt={key:0,class:"transition-overlay"},Xt={class:"radial-waves"},Yt={class:"floating-shapes"},qt={class:"transition-content"},Nt={class:"transition-text-wrapper"},jt={class:"transition-text"},Ot={class:"text-particles"},Ht={__name:"Post",props:{imageUrl:String,markdownUrl:String},setup(Y){const q=E(()=>A(()=>import("./chunk-Tag--O27YR8u.js"),__vite__mapDeps([0,1,2,3,4,5]))),N=E(()=>A(()=>import("./chunk-IconCategory-Cq-urWfK.js"),__vite__mapDeps([6,4,1,2,3]))),j=E(()=>A(()=>import("./chunk-IconDate-pzOQPdhw.js"),__vite__mapDeps([7,4,1,2,3]))),v=Y,m=h(v.imageUrl||T),o=h({}),f=h(""),z=h("auto"),L=h(0),S=h(0),$=h({}),W=h(!1),k=h(null);let y=null,c=[];const b=h(null);let R=null;class O{constructor(t,s){this.x=Math.random()*t,this.y=Math.random()*s,this.size=Math.random()*2+.5,this.speedX=Math.random()*.5-.25,this.speedY=Math.random()*.5-.25,this.opacity=Math.random()*.5+.2}update(t,s){this.x+=this.speedX,this.y+=this.speedY,this.x>t&&(this.x=0),this.x<0&&(this.x=t),this.y>s&&(this.y=0),this.y<0&&(this.y=s)}draw(t){t.fillStyle=`rgba(102, 126, 234, ${this.opacity})`,t.beginPath(),t.arc(this.x,this.y,this.size,0,Math.PI*2),t.fill()}}function H(){if(!k.value)return;const e=k.value,t=e.parentElement.getBoundingClientRect();e.width=t.width,e.height=t.height,c=[];const s=Math.floor(e.width*e.height/15e3);for(let n=0;n<s;n++)c.push(new O(e.width,e.height))}function B(){if(!k.value)return;const e=k.value,t=e.getContext("2d");t.clearRect(0,0,e.width,e.height),c.forEach(s=>{s.update(e.width,e.height),s.draw(t)});for(let s=0;s<c.length;s++)for(let n=s+1;n<c.length;n++){const d=c[s].x-c[n].x,_=c[s].y-c[n].y,x=Math.sqrt(d*d+_*_);x<100&&(t.strokeStyle=`rgba(102, 126, 234, ${.1*(1-x/100)})`,t.lineWidth=.5,t.beginPath(),t.moveTo(c[s].x,c[s].y),t.lineTo(c[n].x,c[n].y),t.stroke())}y=requestAnimationFrame(B)}function G(){H(),B()}function K(e){const t=e.currentTarget.getBoundingClientRect(),s=(e.clientX-t.left)/t.width,n=(e.clientY-t.top)/t.height;L.value=s,S.value=n,$.value={left:`${e.clientX-t.left}px`,top:`${e.clientY-t.top}px`}}function J(){y&&(cancelAnimationFrame(y),y=null)}const Q=e=>{const t=e.target,s=t.naturalWidth,n=t.naturalHeight,d=s/n,_=Math.min(30,d*13);z.value=`${_}rem`};function Z(e){if(!e)return null;const t=e.split("/").filter(s=>s&&s!=="Posts");return t.length>1?t[0]:null}async function tt(e){if(e)try{const t=`/Posts/${e}/image.png`,s=new Image;s.onload=()=>{f.value=t,console.log("Collection theme loaded:",t)},s.onerror=()=>{console.log("No theme image found for collection:",e),f.value=""},s.src=t}catch(t){console.error("Failed to load collection theme:",t),f.value=""}}async function et(e){console.log("Initializing markdown with URL:",e);try{const s=(await yt.get(e.startsWith("http")?e:new URL(e,import.meta.url).href)).data,{meta:n}=await _t(s);o.value=n,o.value.date&&(o.value.date=at(o.value.date)),console.log("Metadata:",o.value)}catch(t){console.error("Failed to fetch markdown content:",t)}}function at(e){return/^\d{4}-\d{2}-\d{2} \d{2}:\d{2}:\d{2}$/.test(e)?e.split(" ")[0]:e}function st(e){if(console.log("Initializing image with URL:",e),e)if(e.startsWith("http")||e.startsWith("/")){m.value=T;const t=new Image;t.src=e,t.onload=()=>{m.value=e},t.onerror=()=>{console.error("Failed to load image:",e),m.value=""}}else m.value=new URL(e,import.meta.url).href;else m.value="";console.log("Image source set to:",m.value)}function nt(){m.value=T}const D=C(()=>o.value.categories&&o.value.categories.length>0?o.value.categories[o.value.categories.length-1]:""),ot=C(()=>o.value.categories&&o.value.categories.length>0?{name:"CategoryPage",params:{fullPath:o.value.categories.join("/")}}:"#"),it=C(()=>({name:"ArchivePage"})),lt=C(()=>f.value?{backgroundImage:`url(${f.value})`,backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat"}:{});ut(()=>{if(console.log("Component mounted"),v.imageUrl&&st(v.imageUrl),v.markdownUrl){et(v.markdownUrl);const e=Z(v.markdownUrl);e&&tt(e)}});const rt=mt();function ct(){if(!b.value)return;const e=b.value,t=e.getContext("2d");e.width=window.innerWidth,e.height=window.innerHeight;const s=[],n=100,d=e.width/2,_=e.height/2;for(let l=0;l<n;l++){const U=Math.PI*2*l/n;s.push({x:d,y:_,vx:Math.cos(U)*(Math.random()*3+2),vy:Math.sin(U)*(Math.random()*3+2),size:Math.random()*4+2,opacity:1,color:`hsl(${250+Math.random()*30}, 70%, ${50+Math.random()*20}%)`})}function x(){t.fillStyle="rgba(0, 0, 0, 0.05)",t.fillRect(0,0,e.width,e.height),s.forEach((l,U)=>{l.x+=l.vx,l.y+=l.vy,l.opacity-=.01,l.size*=.98,!(l.opacity<=0)&&(t.fillStyle=l.color.replace(")",`, ${l.opacity})`),t.beginPath(),t.arc(l.x,l.y,l.size,0,Math.PI*2),t.fill())}),s.some(l=>l.opacity>0)&&(R=requestAnimationFrame(x))}x()}function V(){W.value=!0,setTimeout(()=>{ct()},100),setTimeout(()=>{dt()},1200)}function dt(){const e=v.markdownUrl.split("/").filter(n=>n),t=e[e.length-1].replace(".md",""),s=e.length>2?e[1]:null;rt.push({name:"PostPage",params:{collection:s,mdName:t}})}return ht(()=>{y&&cancelAnimationFrame(y),R&&cancelAnimationFrame(R)}),(e,t)=>{const s=vt("router-link");return i(),r("div",kt,[a("div",{class:"post-panel",onMouseenter:G,onMousemove:K,onMouseleave:J,style:u({"--mouse-x":L.value,"--mouse-y":S.value})},[f.value?(i(),r("div",{key:0,class:"collection-theme-bg",style:u(lt.value)},null,4)):w("",!0),a("canvas",{ref_key:"particleCanvas",ref:k,class:"particle-canvas"},null,512),a("div",{class:"glow-orb",style:u($.value)},null,4),m.value&&m.value!==I(T)?(i(),r("div",{key:1,class:"image-panel",style:u({width:z.value})},[a("div",xt,[a("img",{src:m.value,alt:"Image",onLoad:Q,onError:nt},null,40,Mt),t[0]||(t[0]=a("div",{class:"image-shimmer"},null,-1))])],4)):w("",!0),a("div",Pt,[t[12]||(t[12]=a("div",{class:"deco-geometry"},[a("div",{class:"deco-circle"}),a("div",{class:"deco-triangle"})],-1)),o.value?(i(),r("div",Ct,[a("div",{class:gt(["main-content-area",{"no-preview":!o.value.pre}])},[a("div",{class:"title-panel",onClick:V},[a("p",It,[(i(!0),r(g,null,p(o.value.title,(n,d)=>(i(),r("span",{key:d,class:"title-char",style:u({"--char-index":d})},M(n===" "?" ":n),5))),128))]),t[1]||(t[1]=a("div",{class:"title-underline"},null,-1))]),o.value.pre?(i(),r("div",{key:0,class:"pre-panel",onClick:V},[a("pre",Tt,M(o.value.pre),1),t[2]||(t[2]=a("div",{class:"pre-gradient-overlay"},null,-1))])):(i(),r("div",bt,[a("div",Rt,[t[4]||(t[4]=a("div",{class:"pattern-line left-line"},null,-1)),a("div",Ut,[t[3]||(t[3]=a("span",{class:"center-ornament"},"❖",-1)),a("div",At,[(i(),r(g,null,p(6,n=>a("span",{class:"accent",key:n,style:u({"--accent-index":n})},"✦",4)),64))])]),t[5]||(t[5]=a("div",{class:"pattern-line right-line"},null,-1))]),t[6]||(t[6]=a("p",{class:"decorative-text"},"阅读以启智 · 思考以明理",-1))]))],2),a("div",Et,[a("div",Ft,[D.value?(i(),r("div",zt,[a("div",Lt,[P(I(N),{class:"meta-icon"}),t[7]||(t[7]=a("div",{class:"icon-ripple"},null,-1))]),P(s,{to:ot.value,class:"meta-link"},{default:F(()=>[a("span",St,M(D.value),1),t[8]||(t[8]=a("span",{class:"link-arrow"},"→",-1))]),_:1},8,["to"])])):w("",!0),o.value.date?(i(),r("div",$t,[a("div",Wt,[P(I(j),{class:"meta-icon"}),t[9]||(t[9]=a("div",{class:"icon-ripple"},null,-1))]),P(s,{to:it.value,class:"meta-link"},{default:F(()=>[a("span",Bt,M(o.value.date),1),t[10]||(t[10]=a("span",{class:"link-arrow"},"→",-1))]),_:1},8,["to"])])):w("",!0)]),t[11]||(t[11]=a("div",{class:"props-divider"},[a("div",{class:"divider-glow"})],-1)),a("div",Dt,[(i(!0),r(g,null,p(o.value.tags,(n,d)=>(i(),X(I(q),{key:d,tagname:n,style:u({"--tag-index":d}),class:"animated-tag"},null,8,["tagname","style"]))),128))])])])):w("",!0),t[13]||(t[13]=a("div",{class:"scan-line"},null,-1))])],36),(i(),X(ft,{to:"body"},[P(pt,{name:"page-transition"},{default:F(()=>[W.value?(i(),r("div",Vt,[a("canvas",{ref_key:"transitionCanvas",ref:b,class:"transition-canvas"},null,512),a("div",Xt,[(i(),r(g,null,p(5,n=>a("div",{class:"wave",key:n,style:u({"--wave-delay":n*.1+"s"})},null,4)),64))]),a("div",Yt,[(i(),r(g,null,p(8,n=>a("div",{class:"shape shape-circle",key:"c"+n,style:u({"--shape-delay":Math.random()*.5+"s","--shape-x":Math.random()*100+"%","--shape-y":Math.random()*100+"%"})},null,4)),64)),(i(),r(g,null,p(6,n=>a("div",{class:"shape shape-square",key:"s"+n,style:u({"--shape-delay":Math.random()*.5+"s","--shape-x":Math.random()*100+"%","--shape-y":Math.random()*100+"%"})},null,4)),64))]),a("div",qt,[t[14]||(t[14]=a("div",{class:"transition-spinner"},[a("div",{class:"spinner-ring"}),a("div",{class:"spinner-ring"}),a("div",{class:"spinner-ring"})],-1)),a("div",Nt,[a("p",jt,M(o.value.title),1),a("div",Ot,[(i(),r(g,null,p(20,n=>a("span",{key:n,class:"text-particle",style:u({"--particle-delay":Math.random()*.3+"s","--particle-angle":Math.random()*360+"deg"})},null,4)),64))])]),t[15]||(t[15]=a("div",{class:"loading-bar"},[a("div",{class:"loading-progress"})],-1))])])):w("",!0)]),_:1})]))])}}},Qt=wt(Ht,[["__scopeId","data-v-4533c9f6"]]);export{Qt as default};
