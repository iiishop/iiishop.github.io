import{r as u,f as O,j as S,b as l,o as r,e as s,z as B,M as I,F as M,k as E,y as _,E as T,t as P}from"./entry-index-B6sojzRE.js";import{_ as $}from"./chunk-_plugin-vue_export-helper-DlAUqK2U.js";import"./chunk-mermaid-lib-C3SUPDTN.js";const q={class:"toc-header"},H=["aria-label"],z={key:0,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},D={key:1,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},F={class:"toc-nav"},L={key:0,class:"toc-list"},N=["href","onClick"],j={class:"toc-text"},A={key:1,class:"toc-empty"},R={__name:"TOCPanel",props:{contentSelector:{type:String,default:".post-content.markdown"}},setup(b,{expose:w}){const m=b,i=u([]),d=u(""),a=u(!1),c=u(null),v=u(null),p=()=>{const o=document.querySelector(m.contentSelector);if(!o)return;const e=o.querySelectorAll("h2, h3, h4"),t=[];e.forEach((n,f)=>{const C=parseInt(n.tagName.substring(1)),y=n.textContent.trim(),k=n.id||`heading-${f}`;n.id||(n.id=k),t.push({id:k,text:y,level:C,element:n})}),i.value=t,x()},x=()=>{if(c.value&&c.value.disconnect(),i.value.length===0)return;const o={rootMargin:"-80px 0px -80% 0px",threshold:0};c.value=new IntersectionObserver(e=>{e.forEach(t=>{t.isIntersecting&&(d.value=t.target.id)})},o),i.value.forEach(e=>{e.element&&c.value.observe(e.element)})},h=o=>{const e=document.getElementById(o);if(e){const f=e.getBoundingClientRect().top+window.pageYOffset-80;window.scrollTo({top:f,behavior:"smooth"}),d.value=o}},g=()=>{const o=document.querySelector(m.contentSelector);if(!o){setTimeout(g,500);return}v.value=new MutationObserver(()=>{p()}),v.value.observe(o,{childList:!0,subtree:!0}),p()};return O(()=>{g()}),S(()=>{c.value&&c.value.disconnect(),v.value&&v.value.disconnect()}),w({extractTOC:p,scrollToHeading:h}),(o,e)=>(r(),l("div",{class:_(["toc-panel",{"toc-collapsed":a.value}])},[s("div",q,[e[3]||(e[3]=s("h3",{class:"toc-title"},"目录",-1)),s("button",{class:"toc-toggle",onClick:e[0]||(e[0]=t=>a.value=!a.value),"aria-label":a.value?"展开目录":"收起目录"},[a.value?(r(),l("svg",z,e[1]||(e[1]=[s("path",{d:"M19 9l-7 7-7-7"},null,-1)]))):(r(),l("svg",D,e[2]||(e[2]=[s("path",{d:"M19 15l-7-7-7 7"},null,-1)])))],8,H)]),B(s("nav",F,[i.value.length>0?(r(),l("ul",L,[(r(!0),l(M,null,E(i.value,t=>(r(),l("li",{key:t.id,class:_(["toc-item",`toc-level-${t.level}`,{"toc-active":d.value===t.id}])},[s("a",{href:`#${t.id}`,onClick:T(n=>h(t.id),["prevent"]),class:"toc-link"},[e[4]||(e[4]=s("span",{class:"toc-indicator"},null,-1)),s("span",j,P(t.text),1)],8,N)],2))),128))])):(r(),l("div",A,e[5]||(e[5]=[s("p",null,"暂无目录",-1)])))],512),[[I,!a.value]])],2))}},G=$(R,[["__scopeId","data-v-c985b334"]]);export{G as default};
