const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/chunk-Post-BO8bCUf_.js","assets/chunk-mermaid-lib-CtMrMl2-.js","assets/entry-index-CVwcNbOi.js","assets/asset-index-DQTw5x8l.css","assets/chunk-_plugin-vue_export-helper-DlAUqK2U.js","assets/asset-Post-BIKJ-ZNa.css"])))=>i.map(i=>d[i]);
import{_ as q}from"./chunk-mermaid-lib-CtMrMl2-.js";import{r as m,f as j,n as F,j as V,i as _,A as N,b as p,o as v,a as I,e as f,w as W,F as y,m as T,c as G,u as Y,d as J,T as K,t as Q,k as X,g as Z,p as ee,h as b}from"./entry-index-CVwcNbOi.js";import{g as k}from"./chunk-index-D-nlVayj.js";import{_ as te}from"./chunk-_plugin-vue_export-helper-DlAUqK2U.js";const oe={class:"PostPanel"},se={class:"pagination"},ae=["disabled"],ne=["disabled"],ie=["onClick","disabled"],re=["disabled"],le=["disabled"],ce={__name:"PostPanel",setup(ue){const x=J(()=>q(()=>import("./chunk-Post-BO8bCUf_.js"),__vite__mapDeps([0,1,2,3,4,5]))),P=m({}),s=m(1),r=m(b.PostsPerPage),d=m(0);m(0);async function S(){const t=X.markdowns,o={};for(const[e,n]of Object.entries(t))try{const c=(await Z.get(e.startsWith("http")?e:new URL(e,import.meta.url).href)).data,{meta:i}=await ee(c),u=i.tags&&(Array.isArray(i.tags)?i.tags.includes("公告"):i.tags==="公告"),w=i.title&&i.title.toLowerCase()==="about";!u&&!w&&(o[e]=n)}catch(a){console.error(`Failed to check tags for ${e}:`,a),o[e]=n}P.value=o}function h(){const t=document.querySelector(".LeftList .context"),o=document.querySelector(".RightList .context"),e=t?t.offsetHeight:0,n=o?o.offsetHeight:0;if(d.value=Math.max(e,n),console.log("[PostPanel] Sidebar heights:",{leftHeight:e,rightHeight:n,max:d.value}),d.value===0){r.value=b.PostsPerPage;return}const a=document.querySelectorAll(".posts > *");let c=450;if(a.length>0){const w=Array.from(a).reduce((D,$)=>D+$.offsetHeight,0),B=(a.length-1)*16;c=(w+B)/a.length}const i=Math.ceil(d.value/c),u=Math.max(b.PostsPerPage,i);console.log("[PostPanel] Dynamic calculation:",{sidebarHeight:d.value,avgPostHeight:c,calculatedPosts:i,configMin:b.PostsPerPage,finalPostsPerPage:u}),Math.abs(r.value-u)>=1&&(r.value=u,console.log("[PostPanel] Updated posts per page to:",u))}let g=null;function C(){if(typeof ResizeObserver>"u")return;g=new ResizeObserver(()=>{window.resizeTimeout&&clearTimeout(window.resizeTimeout),window.resizeTimeout=setTimeout(()=>{h()},300)});const t=document.querySelector(".LeftList .context"),o=document.querySelector(".RightList .context");t&&g.observe(t),o&&g.observe(o)}j(async()=>{await S(),await F(),setTimeout(()=>{h()},500),setTimeout(()=>{h()},1e3),setTimeout(()=>{h(),C()},1500)}),V(()=>{g&&g.disconnect(),window.resizeTimeout&&clearTimeout(window.resizeTimeout)});const l=_(()=>Math.ceil(Object.keys(P.value).length/r.value)),L=_(()=>{const t=Object.keys(P.value).map(a=>({key:a,...P.value[a]})).sort((a,c)=>new Date(c.date)-new Date(a.date)),o=(s.value-1)*r.value,e=o+r.value,n=t.slice(o,e);return console.log(`Current Page: ${s.value}, Posts per page: ${r.value}, Start: ${o}, End: ${e}`),n});N(r,()=>{s.value>l.value&&(s.value=1)});const A=t=>{t>=1&&t<=l.value&&(s.value=t,window.scrollTo({top:0,behavior:"smooth"}))},z=()=>{s.value=1,window.scrollTo({top:0,behavior:"smooth"})},E=()=>{s.value=l.value,window.scrollTo({top:0,behavior:"smooth"})},H=()=>{s.value<l.value&&(s.value+=1,window.scrollTo({top:0,behavior:"smooth"}))},M=()=>{s.value>1&&(s.value-=1,window.scrollTo({top:0,behavior:"smooth"}))};function O(t){t.style.opacity=0,t.style.transform="translateY(30px)"}function R(t,o){const e=t.dataset.index*100;setTimeout(()=>{k.to(t,{opacity:1,y:0,duration:.6,ease:"power2.out",onComplete:o})},e)}function U(t,o){k.to(t,{opacity:0,y:-20,scale:.98,duration:.4,ease:"power2.in",onComplete:o})}return(t,o)=>(v(),p("div",oe,[I(K,{name:"list",tag:"div",class:"posts",onBeforeEnter:O,onEnter:R,onLeave:U,appear:""},{default:W(()=>[(v(!0),p(y,null,T(L.value,(e,n)=>(v(),G(Y(x),{key:e.key,imageUrl:e.imageUrl,markdownUrl:e.key,"data-index":n},null,8,["imageUrl","markdownUrl","data-index"]))),128))]),_:1}),f("div",se,[f("button",{onClick:z,disabled:s.value===1},"最前页",8,ae),f("button",{onClick:M,disabled:s.value===1},"前一页",8,ne),(v(!0),p(y,null,T(l.value,e=>(v(),p("button",{key:e,onClick:n=>A(e),disabled:s.value===e},Q(e),9,ie))),128)),f("button",{onClick:H,disabled:s.value===l.value},"后一页",8,re),f("button",{onClick:E,disabled:s.value===l.value},"最后页",8,le)])]))}},fe=te(ce,[["__scopeId","data-v-df004c57"]]);export{fe as default};
