import{r as u,i as j,f as O,s as q,v as G,k as B,g as V,p as J,c as K,w as z,o as d,e as t,x as Q,l as I,t as g,y as L,a as U,T as W,b as p,F as R,m as $,q as H}from"./entry-index-BCWviSf7.js";import X from"./chunk-BaseLayout-PkX32Ab_.js";import{_ as Y}from"./chunk-_plugin-vue_export-helper-DlAUqK2U.js";import"./chunk-mermaid-lib-PTTmCi0X.js";const Z={class:"hero-content"},ee={class:"collection-meta"},te={class:"collection-title"},oe={class:"collection-stats"},ae={class:"stat-item"},se={class:"stat-item"},le={class:"timeline-container"},ne=["onClick"],ie={class:"card-content"},re={class:"card-header"},ce={class:"article-title"},de={class:"article-date"},ge={key:0,class:"article-preview"},me={class:"article-meta"},he={key:0,class:"tags"},ue={__name:"CollectionPage",props:{collectionName:String},setup(S){const k=S,P=q(),w=G(),_=u(""),y=u(""),x=u(""),C=u([]),b=u("rgba(102, 126, 234, 0.3)"),D=u(!1),T=j(()=>({backgroundImage:`url(${x.value})`,"--dominant-color":b.value})),A=()=>{w.back()},E=l=>{const e=l.replace(/^\//,"").split("/");let o=null,a="";e.length>=3?(o=e[1],a=e[2]):e.length===2&&(a=e[1]);const n=a.replace(".md","");console.log("[CollectionPage] Navigating to article:",{path:l,collection:o,mdName:n}),o?w.push({name:"PostPage",params:{collection:o,mdName:n}}):w.push({name:"PostPage",params:{mdName:n}})},F=async l=>new Promise(e=>{const o=new Image;o.onload=()=>{try{const a=document.createElement("canvas"),n=a.getContext("2d");a.width=o.width,a.height=o.height,n.drawImage(o,0,0);const m=n.getImageData(0,0,a.width,a.height).data,h=[];for(let s=0;s<m.length;s+=40){const i=m[s],c=m[s+1],v=m[s+2];(i<240||c<240||v<240)&&h.push([i,c,v])}if(h.length>0){const s=h.reduce((i,c)=>[i[0]+c[0],i[1]+c[1],i[2]+c[2]],[0,0,0]).map(i=>Math.round(i/h.length));e(`rgba(${s[0]}, ${s[1]}, ${s[2]}, 0.3)`)}else e("rgba(102, 126, 234, 0.3)")}catch(a){console.warn("Cannot extract color from image (CORS):",a),e("rgba(102, 126, 234, 0.3)")}},o.onerror=()=>{console.warn("Error loading image for color extraction"),e("rgba(102, 126, 234, 0.3)")},o.src=l});return O(async()=>{console.log("[CollectionPage] Component mounted"),console.log("[CollectionPage] Props collectionName:",k.collectionName),console.log("[CollectionPage] Route params:",P.params),setTimeout(()=>{D.value=!0},100);const l=k.collectionName||P.params.name;if(console.log("[CollectionPage] Collection name:",l),!l){console.error("[CollectionPage] No collection name found, redirecting to home"),w.push("/");return}_.value=l,console.log("[CollectionPage] globalVar.collections:",B.collections);const e=B.collections[l];console.log("[CollectionPage] Collection data:",e),e&&(y.value=e.date,x.value=e.image,e.image&&(b.value=await F(e.image)));try{const a=(await V.get("/assets/PostDirectory.json")).data;if(console.log("[CollectionPage] PostDirectory loaded:",a),a[l]&&a[l].Markdowns){const n=a[l].Markdowns;console.log("[CollectionPage] Found markdowns:",n);const m=n.map(async s=>{var i,c,v,M,N;try{const f=await V.get(s.path),r=await J(f.data);return console.log("[CollectionPage] Article metadata:",{path:s.path,metadata:r}),{id:s.id,path:s.path,title:((i=r.meta)==null?void 0:i.title)||r.title||"无标题",date:((c=r.meta)==null?void 0:c.date)||r.date||"",pre:((v=r.meta)==null?void 0:v.pre)||r.pre||"",tags:((M=r.meta)==null?void 0:M.tags)||r.tags||[],categories:((N=r.meta)==null?void 0:N.categories)||r.categories||[]}}catch(f){return console.error(`Failed to load article: ${s.path}`,f),null}}),h=await Promise.all(m);C.value=h.filter(s=>s!==null).sort((s,i)=>new Date(i.date)-new Date(s.date)),console.log("[CollectionPage] Loaded articles:",C.value)}else console.warn("[CollectionPage] No markdowns found for collection:",l),console.log("[CollectionPage] Available collections in postDirectory:",Object.keys(a))}catch(o){console.error("[CollectionPage] Error loading PostDirectory:",o)}}),(l,e)=>(d(),K(X,{showTipList:!1,showInfoList:!1},{main:z(()=>[t("button",{class:"elegant-back-button",onClick:A,title:"返回"},e[0]||(e[0]=[t("svg",{viewBox:"0 0 24 24",width:"20",height:"20",fill:"none",stroke:"currentColor","stroke-width":"2.5","stroke-linecap":"round","stroke-linejoin":"round"},[t("path",{d:"M19 12H5M12 19l-7-7 7-7"})],-1),t("span",{class:"back-text"},"返回",-1)])),t("div",{class:Q(["collection-archive",{"page-ready":D.value}])},[t("div",{class:"hero-section",style:I(T.value)},[e[3]||(e[3]=t("div",{class:"hero-overlay"},null,-1)),t("div",Z,[t("div",ee,[t("h1",te,g(_.value),1),t("div",oe,[t("span",ae,[e[1]||(e[1]=t("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"currentColor"},[t("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"})],-1)),L(" "+g(C.value.length)+" 篇文章 ",1)]),t("span",se,[e[2]||(e[2]=t("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"currentColor"},[t("path",{d:"M9 11H7v2h2v-2zm4 0h-2v2h2v-2zm4 0h-2v2h2v-2zm2-7h-1V2h-2v2H8V2H6v2H5c-1.11 0-1.99.9-1.99 2L3 20c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 16H5V9h14v11z"})],-1)),L(" "+g(y.value),1)])])])]),e[4]||(e[4]=t("div",{class:"scroll-indicator"},[t("svg",{viewBox:"0 0 24 24",width:"24",height:"24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("path",{d:"M12 5v14M19 12l-7 7-7-7"})])],-1))],4),t("div",le,[e[7]||(e[7]=t("div",{class:"timeline-line"},null,-1)),U(W,{name:"article-list",appear:""},{default:z(()=>[(d(!0),p(R,null,$(C.value,(o,a)=>(d(),p("article",{key:o.id,class:"article-card",style:I({"--index":a}),onClick:n=>E(o.path)},[e[6]||(e[6]=t("div",{class:"timeline-dot"},null,-1)),t("div",ie,[t("div",re,[t("h2",ce,g(o.title),1),t("time",de,g(o.date),1)]),o.pre?(d(),p("p",ge,g(o.pre),1)):H("",!0),t("div",me,[o.tags&&o.tags.length?(d(),p("div",he,[(d(!0),p(R,null,$(o.tags.slice(0,3),n=>(d(),p("span",{key:n,class:"tag"},g(n),1))),128))])):H("",!0),e[5]||(e[5]=t("div",{class:"read-more"},[t("span",null,"阅读全文"),t("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("path",{d:"M5 12h14M12 5l7 7-7 7"})])],-1))])])],12,ne))),128))]),_:1})])],2)]),_:1}))}},fe=Y(ue,[["__scopeId","data-v-8d9c2261"]]);export{fe as default};
